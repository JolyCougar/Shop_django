{% extends 'include/base.html' %}
{% load add_class %}
{% block title %}
    Сменить информацию {{ user.username }}
{% endblock %}

{% block filters %}
    {% include 'include/profile_menu.html' %}
{% endblock %}

{% block content %}
    <h2>Обновить профиль</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Аватар -->
        <div class="form-group form-avatar">
            <label for="{{ form.avatar.id_for_label }}">Аватар</label>
            {% if user.avatar %}
                <!-- Отображаем текущий аватар -->
                <img src="{{ user.avatar.url }}" alt="Аватар" class="img-thumbnail"
                     style="width: 120px; height: 120px; object-fit: cover;">
            {% else %}
                <p>Аватар не установлен</p>
            {% endif %}

            <!-- Кнопка очистки аватара -->
            <button type="button" class="btn btn-danger ml-3" onclick="clearAvatar()">Очистить</button>

            <!-- Стилизация кнопки "Обзор" -->
            <div class="fix">
                <label for="avatarUpload" class="btn btn-primary ml-3">Обзор</label></div>
            <!-- Поле для загрузки файла (скрыто) -->
            <input type="file" name="avatar" id="avatarUpload" class="">
        </div>

        <!-- Имя -->
        <div class="form-group">
            <label for="{{ form.first_name.id_for_label }}">Имя</label>
            {{ form.first_name |add_class:"form-control" }}
        </div>

        <!-- Фамилия -->
        <div class="form-group">
            <label for="{{ form.last_name.id_for_label }}">Фамилия</label>
            {{ form.last_name |add_class:"form-control" }}
        </div>

        <!-- Email -->
        <div class="form-group">
            <label for="{{ form.email.id_for_label }}">E-mail</label>
            {{ form.email |add_class:"form-control" }}
        </div>

        <!-- О себе -->
        <div class="form-group">
            <label for="{{ form.bio.id_for_label }}">О себе</label>
            {{ form.bio |add_class:"form-control" }}
        </div>

        <!-- Кнопка сохранения -->
        <button type="submit" class="btn btn-primary">Сохранить изменения</button>
    </form>

    <!-- Кнопка возврата -->
    <a href="{% url 'account:profile' user.pk %}">
        <button type="button" class="btn btn-secondary mt-3">Назад к профилю</button>
    </a>

    <script>
        // Функция для очистки аватара
        function clearAvatar() {
            if (confirm('Вы уверены, что хотите удалить аватар?')) {
                let avatarInput = document.getElementById('{{ form.avatar.id_for_label }}');
                avatarInput.value = '';  // Очистить поле аватара
            }
        }
    </script>

{% endblock %}

